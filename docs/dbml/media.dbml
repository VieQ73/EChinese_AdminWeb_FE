// media.dbml

// Table Media
Table Media {
  id uuid [primary key, default: `uuid_generate_v4()`]
  original_name varchar(255) [not null]
  display_name varchar(255) [note: "Display name set by Admin (e.g., 'HSK 5 Phần Nghe Bài 3')"]
  s3_path varchar(255) [unique, not null]
  mime_type varchar(50)
  size_bytes int
  uploaded_by uuid [note: "NULL if system-generated or auto-scraped file"]
  usage_type varchar(50) [note: "Enum: 'mocktest_audio', 'vocab_image', 'user_avatar', 'system'"]
  created_at timestamptz [default: `CURRENT_TIMESTAMP`]
  
  Note: '''
  - Quản lý tập trung các tài nguyên file (audio, image).
  - Rất quan trọng cho file Vocabulary images (tự động cào) và MockTest Audios (cần tên rõ ràng).
  '''
  
  Indexes {
    s3_path [unique]
    created_at [type: btree]
  }
}

// Relationships
Ref: Media.uploaded_by > Users.id [delete: set null]